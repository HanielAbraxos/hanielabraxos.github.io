!function(t){"use strict";for(var e,n=0,a="webkit moz ms o".split(" "),r=t.requestAnimationFrame,o=t.cancelAnimationFrame,i=0;i<a.length&&(!r||!o);i++)e=a[i],r=r||t[e+"RequestAnimationFrame"],o=o||t[e+"CancelAnimationFrame"]||t[e+"CancelRequestAnimationFrame"];function s(t,e,n,a,r){var o=(t-e)/(n-a);return o*r+(e-o*a)}r&&o||(r=function(e,a){var r=(new Date).getTime(),o=Math.max(0,16-(r-n)),i=t.setTimeout((function(){e(r+o)}),o);return n=r+o,i},o=function(e){t.clearTimeout(e)});var l=Modernizr.csstransitions,c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],d=function(t,e){var n=function(t){if(l){if(t.target!=this)return;this.removeEventListener(c,n)}e&&"function"==typeof e&&e.call(this)};l?t.addEventListener(c,n):n()},u=document.querySelector(".container"),f=u.querySelector(".cube"),m=[].slice.call(f.querySelectorAll(".rows > .row")),y=m.length,h=[].slice.call(f.querySelectorAll(".row__seat")),p=document.querySelector(".plan"),v=[].slice.call(p.querySelectorAll(".row__seat")),g=f.querySelector(".screen"),w=g.querySelector("video"),X=g.querySelector("button.action--play"),b=g.querySelector(".intro"),Y=b.querySelector("button.action--seats"),x=document.querySelector(".action--lookaround"),T={rotateX:25,rotateY:15},E=!1,q={width:t.innerWidth,height:t.innerHeight},S=h[0].offsetWidth,k=m[0].children.length,L=4*S,_=800,z=100,W=2,A=2e3,M={speed:1e3,easing:"cubic-bezier(.7,0,.3,1)"},Z={x:k*S+L+W*S,y:1e3,z:3e3},F={translateX:0,translateY:Z.y/3.5,translateZ:0,rotateX:-15,rotateY:0},P=F;function V(t){f.style.WebkitTransform=f.style.transform=t?"translate3d(0,0,"+A+"px) rotate3d(1,0,0,"+t.rotateX+"deg) rotate3d(0,1,0,"+t.rotateY+"deg) translate3d("+t.translateX+"px, "+t.translateY+"px, "+t.translateZ+"px)":"translate3d(0,0,"+A+"px) rotate3d(1,0,0,"+P.rotateX+"deg) rotate3d(0,1,0,"+P.rotateY+"deg) translate3d("+P.translateX+"px, "+P.translateY+"px, "+P.translateZ+"px)"}function C(t){t=t||M;f.style.WebkitTransition="-webkit-transform "+t.speed+"ms "+t.easing,f.style.transition="transform "+t.speed+"ms "+t.easing}function H(){f.style.WebkitTransition=f.style.transition="none"}function O(){var t=q.width/Z.x;u.style.WebkitTransform=u.style.transform="scale3d("+t+","+t+",1)"}function R(){classie.add(x,"action--disabled"),E=!1}function D(){classie.remove(X,"action--shown"),w.currentTime=0,w.play()}function N(){classie.add(X,"action--shown"),w.load()}O(),V({translateX:0,translateY:0,translateZ:1300,rotateX:0,rotateY:0}),function(){var e=function(e){var n;n=e.target,classie.has(n,"row__seat--reserved")||(classie.has(n,"row__seat--selected")?classie.remove(n,"row__seat--selected"):(classie.add(n,"row__seat--selected"),function(e){R(),C();var n=t.getComputedStyle(e.parentNode,null),a=n.getPropertyValue("-webkit-transform")||n.getPropertyValue("-moz-transform")||n.getPropertyValue("-ms-transform")||n.getPropertyValue("-o-transform")||n.getPropertyValue("transform")||"Either no transform set, or browser doesnÂ´t do getComputedStyle";if("none"!==a){var r,o=(r=(r=(r=a.split("(")[1]).split(")")[0]).split(","))[13],i=r[14],l=e.offsetLeft+L/2+e.offsetWidth/2,c=l<Z.x/2?F.translateX+(Z.x/2-l):F.translateX-(l-Z.x/2),u=Z.y/2-(Z.y-Math.abs(o))+e.offsetHeight+10,m=Math.abs(i)+10,h=Z.z-_,p=h-(y-1+W)*z,v=0,g=20,w=0,X=Z.x/2,b=s(v,g,w,X,c),Y=s(0,50,w,X,c),x=s(b,Y,p,h,Math.abs(i));P={translateX:c,translateY:u,translateZ:m,rotateX:0,rotateY:x},V(),d(f,(function(){H()}))}}(h[v.indexOf(n)])))};v.forEach((function(t){t.addEventListener("click",e)}));var n=function(){E?R():(classie.remove(x,"action--disabled"),E=!0)};x.addEventListener("click",n);var a=function(e){r((function(){if(!E)return!1;var n,a,r,o=(a=0,r=0,(n=e)||(n=t.event),n.pageX||n.pageY?(a=n.pageX,r=n.pageY):(n.clientX||n.clientY)&&(a=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=n.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:a,y:r}),i=T.rotateX?P.rotateX-(2*T.rotateX/q.height*o.y-T.rotateX):0,s=T.rotateY?P.rotateY+(2*T.rotateY/q.width*o.x-T.rotateY):0;V({translateX:P.translateX,translateY:P.translateY,translateZ:P.translateZ,rotateX:i,rotateY:s})}))};document.addEventListener("mousemove",a);var o,i,l,c=function(){var t;classie.remove(b,"intro--shown"),classie.add(p,"plan--shown"),classie.add(X,"action--faded"),t=function(){classie.add(x,"action--shown")},C({speed:1500,easing:"ease"}),V(F),d(f,(function(){H(),t.call()}))};Y.addEventListener("click",c),X.addEventListener("click",D),w.addEventListener("ended",N),t.addEventListener("resize",(o=function(e){q={width:t.innerWidth,height:t.innerHeight},O()},i=10,l=!0,function(t){l&&(l=!1,setTimeout((function(){l=!0}),i),o(t))}))}()}(window);